{% extends "base.html" %}
{% load static %}
{% block title %}Tournaments{% endblock %}
{% block body_class %}tournaments-page{% endblock %}
{% block content %}
{% static 'img/tournaments/default.jpg' as DEFAULT_COVER %}
{% if request.user.is_staff %}
<a href="{% url 'tournaments:create' %}" class="tour-create card-dark card-ring">
  <div class="tour-create__icon">+</div>
  <div class="tour-create__text">
    <div class="h3 m-0 fw-800">Create a tournament</div>
    <div class="text-muted mt-1">Create a tournament for your community.</div>
  </div>
</a>
{% endif %}
<div class="tour-list">
  {% for t in tournaments %}
    <a href="{% url 'tournaments:overview' t.pk %}" class="tour-card card-dark">
      <div class="tour-thumb"
           style="background-image:url('{{ t.cover.url|default:DEFAULT_COVER }}');"></div>
      <div class="tour-body">
        <div class="tour-meta">
          {{ t.start_date|date:"d M Y, H:i" }}
        </div>
        <h3 class="tour-title">{{ t.name }}</h3>
        <div class="tour-sub">
          Hosted by {{ t.organizer_name|default:"CS2 Platform" }}
          • {{ t.region|default:"Europe" }}
          • {{ t.team_size|default:5 }}v{{ t.team_size|default:5 }}
          • {{ t.max_teams|default:8 }} slots
        </div>
        <div class="tour-chips">
          {% if t.status == "running" %}
            <span class="chip chip-blue">Ongoing</span>
          {% elif t.status == "upcoming" %}
            <span class="chip chip-warning">Upcoming</span>
          {% else %}
            <span class="chip chip-dark">Finished</span>
          {% endif %}

          {% if t.invite_only %}
            <span class="chip chip-muted">Invite-only</span>
          {% endif %}

          {% if t.registration_open %}
            <span class="chip chip-success">Registration open</span>
          {% elif t.status == "upcoming" %}
            <span class="chip chip-muted">Registration closed</span>
          {% endif %}
          <span class="chip chip-glass">
            {{ t.participants.count|default:0 }} / {{ t.max_teams|default:8 }}
          </span>
        </div>
      </div>
      <div class="tour-more">
        <span class="dot"></span><span class="dot"></span><span class="dot"></span>
      </div>
    </a>
  {% empty %}
    <div class="card card-dark card-ring p-3">No tournaments yet.</div>
  {% endfor %}
</div>
{% endblock %}
