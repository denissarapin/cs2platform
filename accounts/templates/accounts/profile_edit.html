{% extends "base.html" %}
{% block title %}Edit Profile â€” CS2 Platform{% endblock %}

{% block content %}
<div class="d-flex justify-content-center mt-5">
  <div class="card shadow-sm p-4" style="max-width: 450px; width: 100%;">
    <h4 class="text-center mb-4">Edit Profile</h4>

    <form method="post" enctype="multipart/form-data">
      {% csrf_token %}
      <div class="text-center mb-3">
        {% if user.avatar %}
          <img src="{{ user.avatar.url }}" class="rounded-circle mb-2" width="96" height="96" alt="avatar" id="avatarPreview">
        {% else %}
          <img src="https://via.placeholder.com/96" class="rounded-circle mb-2" width="96" height="96" alt="avatar" id="avatarPreview">
        {% endif %}
      </div>

      <div class="mb-3">
        {{ form.username.label_tag }}
        {{ form.username }}
      </div>

      <div class="mb-3">
        {{ form.email.label_tag }}
        {{ form.email }}
      </div>

      <div class="mb-3">
        <label class="form-label d-block mb-2">Upload new avatar</label>
        <label for="avatarInput" class="btn btn-outline-primary">
          <i class="bi bi-upload"></i> Choose file
        </label>
        {{ form.avatar }}
      </div>

      <div class="mb-3">
        {{ form.steam_id.label_tag }}
        {{ form.steam_id }}
      </div>

      <button type="submit" class="btn btn-success w-100 mt-3">
        Save
      </button>
      <a href="{% url 'profile' %}" class="btn btn-outline-secondary w-100 mt-2">Cancel</a>
    </form>
  </div>
</div>

<script>
const fileInput = document.querySelector('input[type="file"]');
fileInput.id = "avatarInput";
fileInput.style.display = "none"; 
fileInput.addEventListener('change', function(e) {
  const file = e.target.files[0];
  if (file) {
    const preview = document.getElementById('avatarPreview');
    preview.src = URL.createObjectURL(file);
  }
});
</script>
{% endblock %}
