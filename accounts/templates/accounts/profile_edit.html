{% extends "base.html" %}
{% block title %}–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å ‚Äî CS2 Platform{% endblock %}

{% block content %}
<div class="d-flex justify-content-center mt-5">
  <div class="card shadow-sm p-4" style="max-width: 450px; width: 100%;">
    <h4 class="text-center mb-4">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</h4>

    <form method="post" enctype="multipart/form-data">
      {% csrf_token %}

      <!-- üë§ –¢–µ–∫—É—â–∏–π –∞–≤–∞—Ç–∞—Ä -->
      <div class="text-center mb-3">
        {% if user.avatar %}
          <img src="{{ user.avatar.url }}" class="rounded-circle mb-2" width="96" height="96" alt="avatar" id="avatarPreview">
        {% else %}
          <img src="https://via.placeholder.com/96" class="rounded-circle mb-2" width="96" height="96" alt="avatar" id="avatarPreview">
        {% endif %}
      </div>

      <!-- –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
      <div class="mb-3">
        {{ form.username.label_tag }}
        {{ form.username }}
      </div>

      <!-- Email -->
      <div class="mb-3">
        {{ form.email.label_tag }}
        {{ form.email }}
      </div>

      <!-- üì∏ –ö—Ä–∞—Å–∏–≤–∞—è –∫–Ω–æ–ø–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–≤–∞—Ç–∞—Ä–∞ -->
      <div class="mb-3">
        <label class="form-label d-block mb-2">–ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–π –∞–≤–∞—Ç–∞—Ä</label>
        <label for="avatarInput" class="btn btn-outline-primary">
          <i class="bi bi-upload"></i> –í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª
        </label>
        {{ form.avatar }}
      </div>

      <!-- Steam ID -->
      <div class="mb-3">
        {{ form.steam_id.label_tag }}
        {{ form.steam_id }}
      </div>

      <button type="submit" class="btn btn-success w-100 mt-3">
        üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
      </button>
      <a href="{% url 'profile' %}" class="btn btn-outline-secondary w-100 mt-2">–û—Ç–º–µ–Ω–∞</a>
    </form>
  </div>
</div>

<!-- ‚úÖ JS –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∞–≤–∞—Ç–∞—Ä–∞ -->
<script>
const fileInput = document.querySelector('input[type="file"]');
fileInput.id = "avatarInput";
fileInput.style.display = "none"; // –ø—Ä—è—á–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–ª–µ

fileInput.addEventListener('change', function(e) {
  const file = e.target.files[0];
  if (file) {
    const preview = document.getElementById('avatarPreview');
    preview.src = URL.createObjectURL(file);
  }
});
</script>
{% endblock %}
